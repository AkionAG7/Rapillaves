{% extends "base.html" %}
{% block content %}
    <div class="container">
        <h1>Proveedores</h1>
    
        <div class="inventory_options">
            <form method="get" class="inventory_things">
                <div class="busqueda_container">
                    <input class="filtro_nombre" type="text" name="search" value="{{search}}" placeholder="Buscar por nombre">
                    <button class="btn_search" type="submit">Buscar</button>
                </div>
            </form>
            <button class="btn_add" onclick="openModal()">Agregar proveedor</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Nombre</th>
                    <th>Correo</th>
                    <th>Teléfono</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                {% for proveedor in proveedores %}
                <tr>
                    <td>{{proveedor.name}}</td>
                    <td>{{proveedor.email}}</td>
                    <td>{{proveedor.number_phone}}</td>
                    <td>
                        <div class="btn_actions">
                            <a href="{% url 'proveedor' proveedor.id %}">
                                <i class="fa-solid fa-eye" style="color: #0a0a0a;"></i>
                            </a>
                            <a href="{% url 'proveedor_update' proveedor.id %}">
                                <i class="fa-solid fa-pen-to-square" style="color: #030303;"></i>
                            </a>
                            <a href="#" class="btn-status" data-id="{{proveedor.id}}" data-name="{{proveedor.name}}">
                                <i class="fa-solid fa-delete-left" style="color: #000000;"></i>
                            </a>
                        </div>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="4">No se encuentran proveedores registrados</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <div class="pagination">
            {% if proveedores.has_previous %}
                <a href="?page={{ proveedores.previous_page_number }}&search={{ search }}">«</a>
            {% endif %}

            <span>Página {{ proveedores.number }} de {{ proveedores.paginator.num_pages }}</span>

            {% if proveedores.has_next %}
                <a href="?page={{ proveedores.next_page_number }}&search={{ search }}">»</a>
            {% endif %}
        </div>
    </div>
<script>

document.querySelectorAll(".btn-status").forEach(btn => {
  btn.addEventListener("click", (e) => {
    e.preventDefault();

    const proveedorId = btn.dataset.id;
    const proveedorName = btn.dataset.name;

    openStatusProveedorModal(proveedorId, proveedorName);
  });
});
</script>
{% include "inventory/modals/proveedor_create_update_modal.html" %}
{% include "inventory/modals/show_proveedor_modal.html" %}
{% include "inventory/modals/proveedor_change_status_modal.html" %}
{% endblock %}
